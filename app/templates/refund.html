{% extends "skeleton.html" %}

{% import "_macros.html" as macros %}

{% block page_only_styles %}
<link href="{{ url_for('static', filename='vendor/select2/select2.min.css') }}" rel="stylesheet" media="screen">
<link href="{{ url_for('static', filename='vendor/DataTables/css/DT_bootstrap.css') }}" rel="stylesheet" media="screen">
<link href="{{ url_for('static', filename='vendor/bootstrap-touchspin/jquery.bootstrap-touchspin.min.css') }}" rel="stylesheet" media="screen">
<link href="{{ url_for('static', filename='vendor/select2/select2.min.css') }}" rel="stylesheet" media="screen">
<link href="{{ url_for('static', filename='vendor/bootstrap-datepicker/bootstrap-datepicker3.standalone.min.css') }}" rel="stylesheet" media="screen">
<link href="{{ url_for('static', filename='vendor/bootstrap-timepicker/bootstrap-timepicker.min.css') }}" rel="stylesheet" media="screen">
<style type="text/css">
    td.details-control {
        background: url("{{ url_for('static', filename='assets/images/details_open.png') }}") no-repeat center center;
        cursor: pointer;
    }
    tr.shown td.details-control {
        background: url("{{ url_for('static', filename='assets/images/details_close.png') }}") no-repeat center center;
    }
</style>
{% endblock %}

{% block page_main_title %}Refund{% endblock %}

{% block page_main_desc %}The refunds data fetched from the WDT interface.{% endblock page_main_desc %}

{% block page_content %}
<div class="container-fluid container-fullw bg-white">
    <div class="row">
        <div class="col-md-12">
            <!-- start: QUERY CONDITION -->
            <form id="qry-form" method="POST" action="{{ url_for('main.refund') }}">
                {{ form.hidden_tag() }}
                <div class="panel panel-white" id="panel1">
                    <div class="panel-heading">
                        <h4 class="panel-title text-primary">Query Condition</h4>
                        <ul class="panel-heading-tabs border-light">
                            <li>
                                <div class="pull-right">
                                    <div class="form-actions">
                                        <button type="submit" class="btn btn-azure" data-toggle="modal" data-target="#loading_modal">Query</button>
                                    </div>
                                </div>
                            </li>
                            <li class="panel-tools">
                                <a data-original-title="Collapse" data-toggle="tooltip" data-placement="top" class="btn btn-transparent btn-sm panel-collapse" href="#"><i class="ti-minus collapse-off"></i><i class="ti-plus collapse-on"></i></a>
                            </li>
                        </ul>
                    </div>
                    <div class="panel-body">
                       <div class="row">
                            <div class="col-sm-6">
                                {{ macros.errors_widget(form.qcd_logtime_start) }}
                                <div class="form-group">
                                    <div class="checkbox clip-check check-primary">
                                        {{ form.qcc_logtime(disabled="disabled") }}
                                        <label for="{{ form.qcc_logtime.id }}">
                                            Log Time
                                        </label>
                                    </div>
                                    <div class="input-group input-daterange datepicker">
                                        {{ form.qcd_logtime_start(class_="form-control") }}
                                        <span class="input-group-addon bg-primary">to</span>
                                        {{ form.qcd_logtime_end(class_="form-control") }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    {{ form.qcd_handled() }}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
            <!-- end: QUERY CONDITION -->
            <!-- start: EXPORT -->
            <!--<div class="row">-->
                <!--<div class="btn-group pull-right">-->
                    <!--<a class="btn btn-azure" href="javascript:;">-->
                        <!--&lt;!&ndash;data-placement="top" data-toggle="tooltip" data-original-title="print the data.">&ndash;&gt;-->
                        <!--<i class="fa fa-print"></i>-->
                    <!--</a>-->
                    <!--<button type="button" class="btn btn-azure">-->
                        <!--&lt;!&ndash;data-placement="top" data-toggle="tooltip" data-original-title="export data in a specified format.">&ndash;&gt;-->
                        <!--Export-->
                    <!--</button>-->
                    <!--<button type="button" class="btn btn-azure dropdown-toggle" data-toggle="dropdown" aria-expanded="true">-->
                        <!--<span class="caret"></span>-->
                    <!--</button>-->
                    <!--<ul class="dropdown-menu dropdown-light pull-right" role="menu">-->
                        <!--<li>-->
                            <!--<a href="javascript:;">-->
                                <!--<i class="fa fa-file-code-o"> .json</i>-->
                            <!--</a>-->
                        <!--</li>-->
                        <!--<li>-->
                            <!--<a href="{{ url_for('main.exec_plan_export_xls')}}">-->
                                <!--<i class="fa fa-file-excel-o"> .xls</i>-->
                            <!--</a>-->
                        <!--</li>-->
                        <!--<li>-->
                            <!--<a href="javascript:;">-->
                                <!--<i class="fa fa-file-text-o"> .csv</i>-->
                            <!--</a>-->
                        <!--</li>-->
                        <!--<li>-->
                            <!--<a href="javascript:;">-->
                                <!--<i class="fa fa-file-pdf-o"> .pdf</i>-->
                            <!--</a>-->
                        <!--</li>-->
                    <!--</ul>-->
                <!--</div>-->
            <!--</div>-->
            <!-- end: EXPORT -->
            <!-- start: DATA TABLE -->
            <table style="width:100%" class="table table-striped table-bordered table-hover table-full-width" id="sample_1">
                <thead>
                    <tr>
                        <th class="center"></th>
                        <th class="center">#</th>
                        <th>Log Time</th>
                        <th class="hidden-xs">Handled</th>
                        <th>Entries Count</th>
                        <th>Start Time</th>
                        <th>End Time</th>
                        <th class="hidden-xs">Message</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
                <tfoot>
                    <tr>
                        <th class="center"></th>
                        <th class="center">#</th>
                        <th>Log Time</th>
                        <th class="hidden-xs">Handled</th>
                        <th>Entries Count</th>
                        <th>Start Time</th>
                        <th>End Time</th>
                        <th class="hidden-xs">Message</th>
                    </tr>
                </tfoot>
            </table>
            <!-- end: DATA TABLE -->
        </div>
    </div>
</div>
{% endblock page_content %}

{% block page_only_scripts %}
<script src="{{ url_for('static', filename='vendor/maskedinput/jquery.maskedinput.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendor/bootstrap-touchspin/jquery.bootstrap-touchspin.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendor/autosize/autosize.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendor/selectFx/classie.js') }}"></script>
<script src="{{ url_for('static', filename='vendor/selectFx/selectFx.js') }}"></script>
<script src="{{ url_for('static', filename='vendor/select2/select2.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendor/bootstrap-datepicker/bootstrap-datepicker.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendor/bootstrap-timepicker/bootstrap-timepicker.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendor/DataTables/jquery.dataTables.min.js') }}"></script>
{% endblock %}

{% block page_event_handle_scripts %}
{{ super() }}
<script src="{{ url_for('static', filename='assets/js/form-elements.js') }}"></script>
<script src="{{ url_for('static', filename='assets/js/custom/refund-data-table.js') }}"></script>
<script>
    jQuery(document).ready(function() {
        Main.init();
        FormElements.init();
        // 由于 js 文件独立，因此 jinja2 模板的变量不能直接使用，需要作为参数传递进来。
        TableData.init(
                "{{ exec_mode }}",
                {{ data|tojson }},
                "{{ url_for('main.refund_data') }}",
                "{{ AppConfig['WEBWDT_DATA_PER_PAGE'] }}",
                "{{ form.qcd_logtime_start.data }}",
                "{{ form.qcd_logtime_end.data }}",
                "{{ form.qcd_handled.data }}"
        );
    });

    // // windows onload 方法是在网页中所有的元素（包括元素的所有关联文件）完全加载到浏览器后才执行。
    // //window.onload = function () {}''
    // $(window).load(function(){
    //     $("#loading_modal").css("display", "none");
    // });
</script>
{% endblock %}